!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("crypto"),require("axios")):"function"==typeof define&&define.amd?define(["crypto","axios"],t):e.findXss=t(e.crypto,e.axios)}(this,function(h,e){"use strict";h=h&&h.hasOwnProperty("default")?h.default:h,e=e&&e.hasOwnProperty("default")?e.default:e;for(var n=[],t=0;t<256;++t)n[t]=(t+256).toString(16).substr(1);var y,q,g=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")},v=0,L=0;var o=function(e,t,r){var o=t&&r||0,n=t||[],i=(e=e||{}).node||y,s=void 0!==e.clockseq?e.clockseq:q;if(null==i||null==s){var u=h.randomBytes(16);null==i&&(i=y=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==s&&(s=q=16383&(u[6]<<8|u[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:L+1,a=f-v+(c-L)/1e4;if(a<0&&void 0===e.clockseq&&(s=s+1&16383),(a<0||v<f)&&void 0===e.nsecs&&(c=0),1e4<=c)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");v=f,q=s;var p=(1e4*(268435455&(f+=122192928e5))+(L=c))%4294967296;n[o++]=p>>>24&255,n[o++]=p>>>16&255,n[o++]=p>>>8&255,n[o++]=255&p;var d=f/4294967296*1e4&268435455;n[o++]=d>>>8&255,n[o++]=255&d,n[o++]=d>>>24&15|16,n[o++]=d>>>16&255,n[o++]=s>>>8|128,n[o++]=255&s;for(var l=0;l<6;++l)n[o+l]=i[l];return t||g(n)}().toString().split("-")[0],i=["main_frame","script","xmlhttprequest"],s=["http://*/*","https://*/*"],c=["get","post","put","delete","patch"],u=function(){};u.prototype.getInfo=function(e){return new URL(e)},u.prototype.parseSearch=function(e){if(null===e||"string"!=typeof e)return!1;var t={},r="",o=[],n={};try{t=new URL(e)}catch(e){return!1}if(""===(r=t.search)||"?"!==r[0])return!1;o=r.slice(1).split("&");for(var i=0;i<o.length;i++){var s=o[i].split("=");n[s[0]]=s[1]}return n},u.prototype.stringifySearch=function(e,t){if(null===e||"object"!=typeof e)return!1;var r=[];for(var o in e)({}).hasOwnProperty.call(e,o)&&r.push(o+"="+e[o]);return void 0===t?""+r.join("&"):t.split("?")[0]+"?"+r.join("&")};var r=function(t){function e(e){t.call(this),console.log(1),this.request=e,this.addPayloadToUrl()}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.addPayloadToUrl=function(){if(this.getUrlInfo=new u,this.urlInfo=this.getUrlInfo.getInfo(this.request.url),""===this.urlInfo.search)return!1;var e=this.getUrlInfo.parseSearch(this.request.url);if(!1===e)return!1;for(var t in e)({}).hasOwnProperty.call(e,t)&&(void 0===e[t]?e[t]=o:e[t]+=o);var r=this.getUrlInfo.stringifySearch(e,this.urlInfo.href);return console.log(r),!0},e}(f),f=function(){this.identifier=o,this.requestList={},this.hookRequest()},a={getIdentifier:{configurable:!0},getRequestList:{configurable:!0}};f.prototype.hookRequest=function(){new p},f.prototype.loadPayload=function(e){new r(e)},a.getIdentifier.get=function(){return this.identifier},a.getRequestList.get=function(){return this.requestList},f.prototype.setRequestList=function(e){this.requestList=e},f.prototype.setRequest=function(e,t){this.requestList[e]=t},Object.defineProperties(f.prototype,a),new f;var p=function(e){function t(){e.call(this),this.onBeforeRequest(),this.onSendHeaders()}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.onBeforeRequest=function(){var r=this;chrome.webRequest.onBeforeRequest.addListener(function(e){var t=e.requestId;return!function(u,f){if(!i.includes(f.type)||-1===f.tabId||Object.keys(u.requestList).includes(f.requestId)||!c.includes(f.method.toLowerCase())||function(){for(var e=u.requestList,t=Object.keys(e),r=t.length;r--;){var o=e[t[r]],n=o.url,i=o.type,s=o.method;if(n===f.url&&i===f.type&&s===f.method)return!0}return!1}())return!0}(r,e)&&(r.setRequest(t,e),!0)},{urls:s},["requestBody"])},t.prototype.onSendHeaders=function(){var n=this;chrome.webRequest.onSendHeaders.addListener(function(e){var t=e.requestId,r=e.requestHeaders,o=n.getRequestList[t];return void 0!==o&&(n.setRequest(t,Object.assign(o,{requestHeaders:r})),n.loadPayload(o),!0)},{urls:s},["requestHeaders"])},t}(f),d=function(){this.identifier=o,this.requestList={},this.hookRequest()},l={getIdentifier:{configurable:!0},getRequestList:{configurable:!0}};return d.prototype.hookRequest=function(){new p},d.prototype.loadPayload=function(e){new r(e)},l.getIdentifier.get=function(){return this.identifier},l.getRequestList.get=function(){return this.requestList},d.prototype.setRequestList=function(e){this.requestList=e},d.prototype.setRequest=function(e,t){this.requestList[e]=t},Object.defineProperties(d.prototype,l),new d,d});
